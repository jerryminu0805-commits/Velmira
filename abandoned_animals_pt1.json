{
  "scenario": {
    "name": "被遗弃的动物（上）",
    "name_en": "Abandoned Animals (Part 1)",
    "map": {
      "width": 15,
      "height": 11,
      "covers": [
        {
          "type": "3x3_cover",
          "positions": [
            [2, 6], [2, 7], [2, 8],
            [3, 6], [3, 7], [3, 8],
            [4, 6], [4, 7], [4, 8]
          ]
        },
        {
          "type": "3x3_cover",
          "positions": [
            [12, 6], [12, 7], [12, 8],
            [13, 6], [13, 7], [13, 8],
            [14, 6], [14, 7], [14, 8]
          ]
        }
      ],
      "coordinate_system": "bottom_left_origin"
    },
    "victory_condition": {
      "type": "hp_threshold",
      "target": "velmira",
      "hp_threshold": 450,
      "description": "战斗在Velmira的HP降至450时结束并进入剧情"
    },
    "units": {
      "boss": {
        "id": "velmira_pretransform",
        "name": "Velmira/佛尔魔拉",
        "title": "赫雷西第三干部（变身前）",
        "position": [8, 10],
        "level": 50,
        "first_encounter": true,
        "grid_size": 1,
        "stats": {
          "hp": 750,
          "sp": 70,
          "sp_mechanics": {
            "stun_at_zero": true,
            "stun_duration": 1,
            "damage_multiplier_while_stunned": 2.0,
            "auto_restore_after_stun": 70,
            "reduces_moves_by": 1
          }
        },
        "passive_abilities": [
          {
            "id": "hot_headed",
            "name": "热血上头",
            "description": "在攻击时有75%增加75%伤害",
            "effect": {
              "type": "damage_boost",
              "trigger": "on_attack",
              "chance": 0.75,
              "damage_multiplier": 1.75
            }
          },
          {
            "id": "bloodthirsty_shovel",
            "name": "嗜血魔铲",
            "description": "每次攻击自动给敌人上一层流血效果（多阶段攻击每阶段都上一层）（每回合开始减少该角色5%的血量）（可叠加）",
            "effect": {
              "type": "apply_debuff",
              "trigger": "on_attack",
              "per_stage": true,
              "debuff": {
                "name": "bleeding",
                "stacks": 1,
                "hp_drain_per_turn": 0.05,
                "stackable": true
              }
            }
          },
          {
            "id": "special_person",
            "name": "特别的人",
            "description": "对Adora的伤害减少20%",
            "effect": {
              "type": "damage_reduction",
              "trigger": "when_damaged_by",
              "target": "adora",
              "reduction": 0.20
            }
          },
          {
            "id": "abandoned_animal",
            "name": "被遗弃的动物",
            "description": "每次攻击有25%的几率失去5点SP",
            "effect": {
              "type": "sp_loss",
              "trigger": "on_attack",
              "chance": 0.25,
              "sp_amount": 5
            }
          },
          {
            "id": "survival_of_fittest",
            "name": "弱肉强食",
            "description": "打到对方单位时更具对方流血层数增加伤害，每一层流血增加10%伤害",
            "effect": {
              "type": "conditional_damage_boost",
              "trigger": "on_attack",
              "condition": "target_has_bleeding",
              "damage_per_stack": 0.10
            }
          }
        ],
        "abilities": [
          {
            "id": "shovel_strike",
            "name": "铲击",
            "cost_moves": 1,
            "pool_chance": 0.70,
            "description": "向面前一格挥舞自己的铁锹造成15点伤害并且恢复自己5点SP",
            "effects": {
              "range": 1,
              "direction": "forward",
              "damage": 15,
              "sp_recovery": 5
            }
          },
          {
            "id": "fun_thrust",
            "name": "这很好玩啊～",
            "cost_moves": 2,
            "pool_chance": 0.60,
            "description": "向面前2格像用枪一样用自己的铁锹戳一下造成15点伤害然后拔出转个圈调整下再次戳一下但是这是3格，造成30点伤害并且恢复自己5点SP",
            "multi_stage": true,
            "stages": [
              {
                "range": 2,
                "direction": "forward",
                "damage": 15
              },
              {
                "range": 3,
                "direction": "forward",
                "damage": 30
              }
            ],
            "effects": {
              "sp_recovery": 5
            }
          },
          {
            "id": "playful",
            "name": "嬉耍",
            "cost_moves": 1,
            "description": "给自己增加一层灵活buff（让敌方个体有30%个几率miss掉攻击，如果敌方一段技能miss了，消耗一层灵活buff）",
            "effects": {
              "type": "apply_buff",
              "target": "self",
              "buff": {
                "name": "agility",
                "stacks": 1,
                "enemy_miss_chance": 0.30,
                "consumed_on_miss": true,
                "stackable": true
              }
            }
          },
          {
            "id": "got_you",
            "name": "抓到你啦！",
            "cost_moves": 2,
            "multi_stage": true,
            "description": "命中面前一整排的第一个目标造成15Hp并将自己拉到目标面前一格，并把对方压倒在地上用铲子狠狠插入对方造成25Hp以及10Sp还有一层恐惧",
            "stages": [
              {
                "type": "hook",
                "target": "forward_row_first",
                "damage": 15,
                "pull_self_to_target": true,
                "pull_distance": "adjacent"
              },
              {
                "type": "finisher",
                "damage": 25,
                "sp_damage": 10,
                "apply_debuff": {
                  "name": "fear",
                  "stacks": 1
                }
              }
            ]
          },
          {
            "id": "head_swing_kill",
            "name": "摆头杀",
            "cost_moves": 3,
            "multi_stage": true,
            "description": "以自己为中心挥舞铲子5x5的格子内所有敌方个体受到35点伤害以及20点SP伤害，然后反方向再挥舞一次造成35点伤害（25%破甲）以及上两层流血",
            "stages": [
              {
                "type": "aoe",
                "area": "5x5_centered",
                "target": "enemies",
                "damage": 35,
                "sp_damage": 20
              },
              {
                "type": "aoe",
                "area": "5x5_centered",
                "target": "enemies",
                "damage": 35,
                "armor_penetration": 0.25,
                "apply_debuff": {
                  "name": "bleeding",
                  "stacks": 2
                }
              }
            ]
          },
          {
            "id": "abandoned_animal_attack",
            "name": "被遗弃的动物",
            "cost_moves": 4,
            "multi_stage": true,
            "description": "以自己为中心挥舞铲子对5x5的格子的所有人造成25点伤害以及15sp伤害，然后在逆时针以自己为中心挥舞铲子对5x5的格子的所有人造成30点伤害以及20sp伤害（如果此阶段打到了两个或以上的单位的话给自己上一层戏谑buff）",
            "stages": [
              {
                "type": "aoe",
                "area": "5x5_centered",
                "target": "all",
                "damage": 25,
                "sp_damage": 15
              },
              {
                "type": "aoe",
                "area": "5x5_centered",
                "direction": "counterclockwise",
                "target": "all",
                "damage": 30,
                "sp_damage": 20,
                "conditional_buff": {
                  "condition": "hits_two_or_more",
                  "buff": {
                    "name": "mockery",
                    "stacks": 1,
                    "description": "如果下一次打到了人给自己上两层灵活buff以及一层暴力buff"
                  }
                }
              }
            ],
            "buff_mechanics": {
              "mockery": {
                "on_next_hit": {
                  "apply_buffs": [
                    {
                      "name": "agility",
                      "stacks": 2
                    },
                    {
                      "name": "violence",
                      "stacks": 1,
                      "description": "下次攻击造成双倍伤害但消耗自10sp并消耗自身一层暴力Buff（多阶段攻击只算第一阶段双倍）",
                      "effect": {
                        "damage_multiplier": 2.0,
                        "sp_cost": 10,
                        "consumed_on_use": true,
                        "first_stage_only": true,
                        "stackable": true
                      }
                    }
                  ],
                  "consumes_mockery": true
                }
              }
            }
          }
        ]
      },
      "player_units": [
        {
          "id": "karma",
          "name": "Karma",
          "position": [7, 2],
          "level": 25,
          "type": "player_controlled"
        },
        {
          "id": "adora",
          "name": "Adora",
          "position": [8, 2],
          "level": 25,
          "type": "player_controlled"
        },
        {
          "id": "dario",
          "name": "Dario",
          "position": [9, 2],
          "level": 25,
          "type": "player_controlled"
        }
      ]
    }
  }
}
