# Velmira

## 被遗弃的动物（上）/ Abandoned Animals (Part 1)

这是一个替换Khathia Boss战的新场景。

### 场景概述

**地图规格**:
- 大小: 15(宽) x 11(高)
- 坐标系: 左下角为(1,1)
- 两个3x3掩体区域

**单位起始位置**:
- Velmira (Boss): (8, 10) - 等级50
- Karma: (7, 2) - 等级25
- Adora: (8, 2) - 等级25
- Dario: (9, 2) - 等级25

### Boss: Velmira/佛尔魔拉 - 赫雷西第三干部（变身前）

**基础属性**:
- HP: 750 (降至450时触发剧情结束战斗)
- SP: 70 (降至0时眩晕1回合，眩晕时受到2倍伤害，眩晕后自动恢复至70)
- 等级: 50
- 占地: 1格

**被动技能**:
1. **热血上头**: 攻击时75%几率增加75%伤害
2. **嗜血魔铲**: 每次攻击自动给敌人上一层流血效果(多阶段攻击每阶段都上)，流血每回合造成5%最大HP伤害，可叠加
3. **特别的人**: 受到Adora的伤害减少20%
4. **被遗弃的动物**: 每次攻击25%几率失去5点SP
5. **弱肉强食**: 对带有流血效果的目标，每层流血增加10%伤害

**主动技能**:
1. **铲击** (1步, 70%权重): 向前1格造成15伤害，恢复5 SP
2. **这很好玩啊～** (2步, 60%权重): 多阶段攻击，前2格造成15伤害，然后前3格造成30伤害，恢复5 SP
3. **嬉耍** (1步): 给自己增加1层灵活buff(敌方30%几率miss，miss时消耗1层)
4. **抓到你啦！** (2步): 多阶段攻击，钩取前方第一个目标造成15伤害并拉近，然后造成25伤害+10 SP伤害+1层恐惧
5. **摆头杀** (3步): 多阶段攻击，5x5范围造成35伤害+20 SP伤害，再次造成35伤害(25%破甲)+2层流血
6. **被遗弃的动物** (4步): 多阶段攻击，5x5范围造成25伤害+15 SP伤害，然后逆时针造成30伤害+20 SP伤害，击中2个或以上目标获得戏谑buff

### 文件说明

- `abandoned_animals_pt1.json`: Boss战场景数据文件，包含完整的地图、单位和技能定义
- `boss_fight.py`: Boss战斗系统实现，包含战斗逻辑、buff系统和伤害计算

### 使用方法

```bash
python3 boss_fight.py
```

### 技术实现

系统实现了完整的：
- Buff/Debuff系统 (流血、灵活、恐惧、眩晕等)
- 被动技能触发机制
- 多阶段攻击系统
- SP机制和眩晕系统
- 条件性buff触发(戏谑、暴力等)
- 伤害计算系统(考虑各种加成和减免)